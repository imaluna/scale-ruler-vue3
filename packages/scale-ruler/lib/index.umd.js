(function(e,E){typeof exports=="object"&&typeof module<"u"?module.exports=E(require("vue")):typeof define=="function"&&define.amd?define(["vue"],E):(e=typeof globalThis<"u"?globalThis:e||self,e.ScaleRuler=E(e.Vue))})(this,function(e){"use strict";const E=e.defineComponent({__name:"CanvasPanel",props:{containerInfo:{type:Object,required:!0},opt:{type:Object,required:!0},transformInfo:{type:Object,required:!0}},setup(c){const y=c,t=e.computed(()=>{var d,n;return{position:"absolute",left:0,top:0,width:((d=y.opt)==null?void 0:d.canvasWidth)+"px",height:((n=y.opt)==null?void 0:n.canvasHeight)+"px",transition:"transform 300ms",transformOrigin:"0 0",transform:`translate(${y.transformInfo.translateX}px, ${y.transformInfo.translateY}px) scale(${y.transformInfo.scale})`,...y.opt.canvasStyle}});return(d,n)=>(e.openBlock(),e.createElementBlock("div",{ref:"canvasPanel",style:e.normalizeStyle(t.value)},null,4))}}),P=e.defineComponent({__name:"ScrollBar",props:{containerInfo:{type:Object,required:!0},opt:{type:Object,required:!0},isY:{type:Boolean,default:!1},scrollBarInfo:{type:Object,required:!0},globalInfo:{type:Object,required:!0},transformInfo:{type:Object,required:!0}},emits:["onMove"],setup(c,{emit:y}){const t=c,d=y,{globalInfo:n,transformInfo:g}=e.toRefs(t),l=e.computed(()=>{const{opt:f,scrollBarInfo:r,isY:m}=t,{scrollBarConfig:s}=f,v={position:"absolute",borderRadius:"4px",backgroundColor:s.bgColor,opacity:t.globalInfo[m?"yOpacity":"xOpacity"]||0,transition:"opacity 300ms",cursor:"pointer",zIndex:s.zIndex,width:(m?s.barSize:r.width)+"px",height:(m?r.height:s.barSize)+"px"};return m?(v.top=r.top+"px",v.right=0):(v.left=r.left+"px",v.bottom=0),v}),u=e.ref(null),i={};function o(f){if(f.preventDefault(),!n.value.scrollBarMouseDown)return;let{translateX:r,translateY:m}=g.value;const s=t.scrollBarInfo,{width:v,height:x}=t.containerInfo;if(t.isY){const L=f.pageY-i.startY;let a=i.top+L;a=Math.min(Math.max(0,a),x-s.height);const p=a*s.totalHeight/x;m=t.opt.containerYPadding-p,g.value.translateY=m}else{const L=f.pageX-i.startX;let a=i.left+L;a=Math.min(Math.max(0,a),v-s.width);const p=a*s.totalWidth/v;r=t.opt.containerXPadding-p,g.value.translateX=r}d("onMove",g.value.translateX,g.value.translateY)}return e.onMounted(()=>{if(u.value){const f=u.value,r=t.isY?"yOpacity":"xOpacity";f.addEventListener("mouseenter",()=>{n.value[r]=t.opt.scrollBarConfig.opacity,n.value[t.isY?"xOpacity":"yOpacity"]=0,n.value.scrollBarEnter=!0}),f.addEventListener("mouseleave",()=>{n.value.scrollBarMouseDown||(n.value.scrollBarEnter=!1,n.value[r]=0)}),f.addEventListener("mousedown",m=>{m.preventDefault(),n.value.scrollBarMouseDown=!0,i.startX=m.pageX,i.startY=m.pageY,i.left=t.scrollBarInfo.left,i.top=t.scrollBarInfo.top,document.addEventListener("mousemove",o)}),document.addEventListener("mouseup",()=>{n.value.scrollBarMouseDown&&(n.value.scrollBarMouseDown=!1,document.removeEventListener("mousemove",o))})}}),(f,r)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"scrollBarRef",ref:u,style:e.normalizeStyle(l.value)},null,4))}}),H=c=>c<=.25?40:c<=.5?20:c<=1?10:c<=2?5:c<=4?2:1,D=c=>{const y=c.getBoundingClientRect(),t=y.top+(document.body.scrollTop||document.documentElement.scrollTop),d=y.left+(document.body.scrollLeft||document.documentElement.scrollLeft);return{top:t,left:d}},_=(c,y,t)=>{const{scale:d,translateX:n,translateY:g}=c;return(y-(t?g:n))/d},j=(c,y,t)=>{const{scale:d,translateX:n,translateY:g}=c,l=y*d;return(t?g:n)+l};function A(c,y,t,d,n,g){const l={coordinate:n,translate:d},u=c.length;if(u>0){let i=0;for(;i<u;){const o=c[i];if(Math.abs(n-o)<=t){l.coordinate=o,l.translate=j(y,o,g);break}else if(o>n)break;i++}}return l}const q=(c,y,t,d)=>{e.nextTick(()=>{const n=d.value;if(n){const g=n.offsetWidth,l=n.offsetHeight,{rulerConfig:u}=c,{bgColor:i,fontFamily:o,fontSize:f,lineColor:r,fontColor:m}=u;if(g>0&&l>0){const s=n.getContext("2d");s.clearRect(0,0,g,l),i&&(s.save(),s.fillStyle=i,s.fillRect(0,0,g,l),s.restore());const v=t?u.yRulerWidth:u.xRulerHeight,{translateX:x,translateY:L,scale:a}=y,p=t?L:x,h=H(a),M=h*a,b=window.devicePixelRatio,O=-p,C=Math.floor(O/M),S=Math.floor(((t?l:g)-p)/M);s.save(),s.fillStyle=r,s.font=`${f*b}px ${o}`,s.translate(.5,.5),s.scale(1/b,1/b),t?s.fillRect((v-1)*b,0,1,l*b):s.fillRect(0,(v-1)*b,g*b,1);for(let w=C;w<=S;w++){s.fillStyle=r;const B=(p+w*M)*b;let R=v/4;w%10===0?R=v*4/5:w%5===0&&(R=v/3),t?s.fillRect((v-R)*b,B,R*b,1):(s.fillRect(B,(v-R)*b,1,R*b),w%10===0&&(s.fillStyle=m,s.fillText(String(w*h),B+2*b,(v+8-R)*b)))}if(s.restore(),t){s.font=`${f}px ${o}`;let w=C;for(;w<=S;)if(w%10)w++;else{s.save();const B=p+w*M+v/2;s.translate(B+v/5,B-v*6/5),s.rotate(Math.PI/2),s.fillText(String(w*h),v*4/5,B),w+=10,s.restore()}}}}})},$=(c,y)=>{const t=e.reactive([0]);function d(o,f=!0){const r=t.indexOf(o);f&&r===-1&&t.push(o),!f&&r>-1&&t.splice(r,1),f&&t.sort((m,s)=>m-s)}function n(o,f=!0){Array.isArray(o)?o.forEach(r=>d(r,f)):d(o,f)}function g(o){n(o)}function l(o){n(o,!1)}const u=e.computed(()=>c.positionLineConfig[y?"adsorptionYList":"adsorptionXList"]);e.watch(()=>u.value,o=>{g(o)},{deep:!0});const i=e.computed(()=>y?c.canvasWidth:c.canvasHeight);return e.watch(()=>i.value,(o,f)=>{f!==void 0&&l(f),g(o)},{immediate:!0}),{adsorptionList:t,modifyAdsorptionList:n}},F=(c,y,t,d,n,g)=>{let l=1;const u=e.reactive([]);let i=-1,o=!1;function f(r){if(o&&i>-1){r.preventDefault();const{xRulerHeight:m,yRulerWidth:s}=c.value.rulerConfig,v=u[i],x=(n?r.pageY:r.pageX)-v.start,L=v.startTranslate+x,a=L>(n?m:s),p=_(d.value,L,n),h=A(t,d.value,c.value.positionLineConfig.adsorptionGap,L,p,n);u[i].showTip=a,u[i].coordinate=h.coordinate}}return e.onMounted(()=>{if(g.value){const r=g.value;r.addEventListener("mousedown",m=>{const s=D(r),v=n?m.pageY:m.pageX,x=v-(n?s.top:s.left),L={startTranslate:x,start:v,id:l,coordinate:_(d.value,x,n),showTip:!1,show:!0,needAnimate:!1};i=l,u[l++]=L,o=!0,document.addEventListener("mousemove",f)}),document.addEventListener("mouseup",()=>{if(document.removeEventListener("mousemove",f),!o||i<0)return;o=!1;const m=u[i],{width:s,height:v}=y.value,{xRulerHeight:x,yRulerWidth:L}=c.value.rulerConfig;m.translate<=(n?x:L)||m.translate>=(n?v:s)?delete u[i]:(u[i].showTip=!1,u[i].needAnimate=!0),i=-1})}}),{positionLineMap:u}},N=(c,y,t,d,n,g,l,u)=>{let i=!1;function o(r){l.value.showTip=r}function f(r){if(!i)return;const m=(n?r.pageY:r.pageX)-l.value.start,s=l.value.startTranslate+m,v=_(d.value,s,n),x=A(t.value,d.value,c.value.positionLineConfig.adsorptionGap,s,v,n);l.value.coordinate=x.coordinate}e.onMounted(()=>{if(g.value){const r=g.value;r.addEventListener("mouseenter",()=>{o(!0)}),r.addEventListener("mouseleave",()=>{console.log({isMouseDown:i}),i||o(!1)}),r.addEventListener("mousedown",m=>{m.preventDefault(),i=!0,l.value.showTip=!0;const s=n?m.pageY:m.pageX;l.value.start=s,l.value.startTranslate=j(d.value,l.value.coordinate,n),l.value.needAnimate=!1,document.addEventListener("mousemove",f)}),document.addEventListener("mouseup",()=>{if(!i)return;i=!1;const{translate:m,id:s}=l.value,{width:v,height:x}=y.value,{xRulerHeight:L,yRulerWidth:a}=c.value.rulerConfig;m<=(n?L:a)||m>=(n?x:v)?u(s):(o(!1),l.value.needAnimate=!0),document.removeEventListener("mousemove",f)})}})},V=e.defineComponent({__name:"PositionLine",props:{containerInfo:{type:Object,required:!0},opt:{type:Object,required:!0},isY:{type:Boolean,default:!1},transformInfo:{type:Object,required:!0},lineInfo:{type:Object,required:!0},adsorptionList:{type:Array,required:!0}},emits:["remove-position-line"],setup(c,{emit:y}){const t=c,{lineInfo:d,adsorptionList:n,transformInfo:g,opt:l,containerInfo:u}=e.toRefs(t),i=e.computed(()=>l.value.positionLineConfig.padding),o=e.computed(()=>2*i.value+1),f=e.computed(()=>j(g.value,d.value.coordinate,t.isY)),r=e.computed(()=>{const{width:h,height:M}=u.value,{isY:b}=t,O=b?`translate(0, ${f.value}px)`:`translate(${f.value}px, 0)`;return{display:d.value.show?"block":"none",position:"absolute",width:(b?h:o.value)+"px",height:(b?o.value:M)+"px",cursor:b?"row-resize":"col-resize",top:(b?-i.value:0)+"px",left:(b?0:-i.value)+"px",transform:O,zIndex:t.opt.positionLineConfig.zIndex,transition:d.value.needAnimate?"transform 300ms":""}}),m=e.computed(()=>{const{isY:h}=t;return{position:"absolute",width:h?"100%":"1px",height:h?"1px":"100%",backgroundColor:l.value.positionLineConfig.lineColor,top:(h?i.value:0)+"px",left:(h?0:i.value)+"px"}}),s=e.ref({}),v=e.computed(()=>{const{isY:h}=t,{width:M,height:b}=u.value,{tipWidth:O,tipHeight:C}=s.value;let S,w;return O&&C?(w=h?"50%":(f.value+o.value+O>=M?-O:o.value)+"px",S=h?(f.value+o.value+C>=b?-C:o.value)+"px":"50%"):(w=h?"50%":o.value+"px",S=h?o.value+"px":"50%"),{position:"absolute",padding:"5px",lineHeight:"18px",minWidth:"80px",backgroundColor:"rgba(0,0,0,.8)",color:"#fff",fontSize:"12px",borderRadius:"4px",userSelect:"none",textAlign:"center",left:w,top:S,transform:h?"translate(-50%, 0)":"translate(0, -50%)",visibility:d.value.showTip?"visible":"hidden"}}),x=e.ref(null),L=y;function a(h){L("remove-position-line",h)}N(l,u,n,g,t.isY,x,d,a);const p=e.ref(null);return e.onMounted(()=>{if(p.value){const h=p.value,M=h.offsetWidth,b=h.offsetHeight;s.value.tipWidth=M,s.value.tipHeight=b}}),(h,M)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"positionLineRef",ref:x,class:"scale-ruler_position-line",style:e.normalizeStyle(r.value)},[e.createElementVNode("div",{class:"scale-ruler_position-line_inner",style:e.normalizeStyle(m.value)},null,4),e.createElementVNode("div",{class:"scale-ruler_position-line_tip",style:e.normalizeStyle(v.value),ref_key:"tipRef",ref:p},e.toDisplayString((c.isY?"Y":"X")+": "+ +e.unref(d).coordinate.toFixed(2)+" px"),5)],4))}}),K=["width","height"],k=e.defineComponent({__name:"Ruler",props:{containerInfo:{type:Object,required:!0},opt:{type:Object,required:!0},isY:{type:Boolean,default:!1},transformInfo:{type:Object,required:!0}},setup(c,{expose:y}){const t=c,{opt:d,transformInfo:n,containerInfo:g}=e.toRefs(t),l=e.computed(()=>{const{isY:a,containerInfo:p,opt:h}=t;return{width:a?h.rulerConfig.yRulerWidth:p.width,height:a?p.height:h.rulerConfig.xRulerHeight}}),u=e.computed(()=>({position:"absolute",left:0,top:0,zIndex:t.opt.rulerConfig.zIndex+(t.isY?0:1)})),i=e.ref();e.watch([()=>t.containerInfo,()=>t.transformInfo],()=>{q(t.opt,t.transformInfo,t.isY,i)},{deep:!0});const{adsorptionList:o,modifyAdsorptionList:f}=$(t.opt,t.isY),{positionLineMap:r}=F(d,g,o,n,!t.isY,i);function m(a){delete r[a]}function s(){Object.keys(r).forEach(a=>{m(a)})}function v(a=!0){Object.keys(r).forEach(p=>{r[p].show=a})}const x=e.ref(!0);function L(a=!0){x.value=a,v(a)}return y({modifyAdsorptionList:f,removeAllPositionLine:s,togglePositionLine:v,toggleRuler:L}),(a,p)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("canvas",{ref_key:"rulerRef",ref:i,style:e.normalizeStyle(u.value),width:l.value.width,height:l.value.height},null,12,K),[[e.vShow,x.value]]),t.opt.usePositionLine?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass("position-line-"+(t.isY?"x":"y"))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(Object.keys(e.unref(r)),h=>(e.openBlock(),e.createBlock(V,{key:h,opt:t.opt,"is-y":!t.isY,"transform-info":t.transformInfo,"container-info":t.containerInfo,"line-info":e.unref(r)[h],"adsorption-list":e.unref(o),onRemovePositionLine:m},null,8,["opt","is-y","transform-info","container-info","line-info","adsorption-list"]))),128))],2)):e.createCommentVNode("",!0)],64))}});function G(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Y,W;function U(){if(W)return Y;W=1;var c=function(p){return y(p)&&!t(p)};function y(a){return!!a&&typeof a=="object"}function t(a){var p=Object.prototype.toString.call(a);return p==="[object RegExp]"||p==="[object Date]"||g(a)}var d=typeof Symbol=="function"&&Symbol.for,n=d?Symbol.for("react.element"):60103;function g(a){return a.$$typeof===n}function l(a){return Array.isArray(a)?[]:{}}function u(a,p){return p.clone!==!1&&p.isMergeableObject(a)?x(l(a),a,p):a}function i(a,p,h){return a.concat(p).map(function(M){return u(M,h)})}function o(a,p){if(!p.customMerge)return x;var h=p.customMerge(a);return typeof h=="function"?h:x}function f(a){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(a).filter(function(p){return Object.propertyIsEnumerable.call(a,p)}):[]}function r(a){return Object.keys(a).concat(f(a))}function m(a,p){try{return p in a}catch{return!1}}function s(a,p){return m(a,p)&&!(Object.hasOwnProperty.call(a,p)&&Object.propertyIsEnumerable.call(a,p))}function v(a,p,h){var M={};return h.isMergeableObject(a)&&r(a).forEach(function(b){M[b]=u(a[b],h)}),r(p).forEach(function(b){s(a,b)||(m(a,b)&&h.isMergeableObject(p[b])?M[b]=o(b,h)(a[b],p[b],h):M[b]=u(p[b],h))}),M}function x(a,p,h){h=h||{},h.arrayMerge=h.arrayMerge||i,h.isMergeableObject=h.isMergeableObject||c,h.cloneUnlessOtherwiseSpecified=u;var M=Array.isArray(p),b=Array.isArray(a),O=M===b;return O?M?h.arrayMerge(a,p,h):v(a,p,h):u(p,h)}x.all=function(p,h){if(!Array.isArray(p))throw new Error("first argument should be an array");return p.reduce(function(M,b){return x(M,b,h)},{})};var L=x;return Y=L,Y}var J=U();const z=G(J),T={scale:1,canScale:!0,maxScale:10,minScale:.1,autoCenter:!0,autoScale:!0,containerAutoSize:!1,containerWidth:1e3,containerHeight:500,containerXPadding:80,containerYPadding:80,canvasWidth:1920,canvasHeight:1e3,proxyScaleKey:!0,useScrollBar:!0,useRuler:!0,usePositionLine:!0,positionLineConfig:{lineColor:"#24aa61",padding:3,adsorptionXList:[],adsorptionYList:[],adsorptionGap:4,zIndex:300},canvasStyle:{},scrollBarConfig:{bgColor:"#000000",opacity:.4,zIndex:500,barSize:8},rulerConfig:{yRulerWidth:30,xRulerHeight:30,bgColor:"#efefef",fontColor:"#000000",fontSize:12,fontFamily:"Arial",lineColor:"#000000",zIndex:400},onScale:()=>{},onMove:()=>{}},Q=function(){const c={};for(const y in T){const t=T[y];typeof t=="object"&&t!==null?c[y]=()=>t:c[y]=t}return c}(),Z=(c,y)=>{const t=e.reactive({width:0,height:0,originWidth:0,originHeight:0});function d(u,i){new ResizeObserver(f=>{for(const r of f)if(r.target===i){const m=i.offsetWidth,s=i.offsetHeight;(m!==t.originWidth||s!==t.originHeight)&&n(u,i)}}).observe(i)}function n(u,i,o=!1){const f=u.value;f.containerAutoSize?(t.width=i.offsetWidth,t.height=i.offsetHeight,t.originWidth=t.width,t.originHeight=t.height,o&&d(u,i)):(t.width=f.containerWidth,t.height=f.containerHeight);const r=getComputedStyle(i);r.boxSizing==="border-box"&&(t.width-=parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),t.height-=parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth)),r.position==="static"&&(t.position="relative")}e.onMounted(()=>{const u=y.value;u&&n(c,u,!0)});const g=e.computed(()=>({width:t.width,height:t.height})),l=e.computed(()=>{const u=c.value,i={overflow:"hidden"};return u.containerAutoSize||(i.width=t.width+"px",i.height=t.height+"px"),t.position&&(i.position=t.position),i});return{containerInfo:g,containerStyle:l}},ee=(c,y)=>{const t=e.reactive({});return e.watch(()=>y.value,()=>{const d=c.value;let n=0,g=0,{scale:l}=d;const{autoCenter:u,autoScale:i}=d,{width:o,height:f}=y.value;if(i){const s=(o-2*d.containerXPadding)/d.canvasWidth,v=(f-2*d.containerYPadding)/d.canvasHeight;l=Math.min(s,v)}t.scale=l;let r=0,m=0;n=d.canvasWidth*l,g=d.canvasHeight*l,u&&(r=Math.floor((o-n)/2),m=Math.floor((f-g)/2),t.translateX=r,t.translateY=m)},{deep:!0}),{transformInfo:t}},te=(c,y,t)=>({scrollBarInfo:e.computed(()=>{const n=c.value,{width:g,height:l}=y.value,{translateX:u,translateY:i,scale:o}=t,f=n.canvasWidth*o+2*n.containerXPadding,r=n.canvasHeight*o+2*n.containerYPadding,m=g<f,s=l<r,v=m||s,x=g*((n.containerXPadding-u)/f),L=l*((n.containerYPadding-i)/r),a=g/f*g,p=l/r*l;return{totalHeight:r,totalWidth:f,left:x,top:L,width:a,height:p,isYLarge:s,isXLarge:m,isLarge:v}})});function I(c,y,t){const d=c.value,{containerXPadding:n,containerYPadding:g,canvasWidth:l,canvasHeight:u}=d,i=l*t,o=u*t,{width:f,height:r}=y.value,m=Math.max((f-i)/2,n),s=Math.max((r-o)/2,g),v=i+2*n>f?f-(i+n):m,x=o+2*g>r?r-(o+g):s;return{maxTranslateX:m,maxTranslateY:s,minTranslateX:v,minTranslateY:x}}const ne=(c,y,t)=>({boundaryInfo:e.computed(()=>I(c,y,t.scale))}),X=(c,y,t,d,n)=>{const g=c.value;let{translateX:l,translateY:u,scale:i}=t;d=Math.min(Math.max(d,g.minScale),g.maxScale);const o=d-i,f=I(c,y,d);l-=o*g.canvasWidth/2,u-=o*g.canvasHeight/2,l=Math.max(Math.min(l,f.maxTranslateX),f.minTranslateX),u=Math.max(Math.min(u,f.maxTranslateY),f.minTranslateY),t.scale=d,t.translateX=l,t.translateY=u,n(d)},oe=(c,y,t)=>{c.value.proxyScaleKey&&document.addEventListener("keydown",d=>{if(c.value.canScale){const n=d.keyCode;if((d.metaKey||d.ctrlKey)&&(n===187||n===189)){d.preventDefault();const g=t.scale+(n===187?.05:-.05);X(c,y,t,g)}}})},re=(c,y,t,d,n,g,l,u,i)=>{let o=null;Object.assign(l,{xOpacity:0,yOpacity:0,scrollBarMouseDown:!1,scrollBarEnter:!1}),e.onMounted(()=>{n.value&&n.value.addEventListener("wheel",f=>{if(c.value.canScale)if(f.metaKey||f.ctrlKey){f.preventDefault();const r=-1*f.deltaY/100,m=t.scale+r;X(c,y,t,m,u)}else{if(!g.value.isLarge||l.scrollBarMouseDown)return;f.preventDefault();let{translateX:r,translateY:m}=t;o&&clearTimeout(o);const s=-f.deltaX,v=-f.deltaY;let x="";const{opacity:L=.4}=c.value.scrollBarConfig,{isXLarge:a,isYLarge:p}=g.value,{maxTranslateX:h,minTranslateX:M,maxTranslateY:b,minTranslateY:O}=d.value;a&&Math.abs(s)>Math.abs(v)&&(r+=s,r=Math.max(Math.min(r,h),M),l.xOpacity=L,l.yOpacity=0,t.translateX=r,x="x"),p&&Math.abs(v)>Math.abs(s)&&(x="y",m+=v,m=Math.max(Math.min(m,b),O),l.yOpacity=L,l.xOpacity=0,t.translateY=m),x&&(i(t.translateX,t.translateY),o=setTimeout(()=>{l.scrollBarEnter||(l[x==="y"?"yOpacity":"xOpacity"]=0)},1e3))}})})};return e.defineComponent({__name:"index",props:e.mergeDefaults({scale:{},minScale:{},maxScale:{},canScale:{type:Boolean},autoCenter:{type:Boolean},autoScale:{type:Boolean},containerAutoSize:{type:Boolean},containerWidth:{},containerHeight:{},containerXPadding:{},containerYPadding:{},canvasWidth:{},canvasHeight:{},proxyScaleKey:{type:Boolean},useScrollBar:{type:Boolean},useRuler:{type:Boolean},usePositionLine:{type:Boolean},positionLineConfig:{},canvasStyle:{},scrollBarConfig:{},rulerConfig:{},onScale:{type:Function},onMove:{type:Function}},Q),emits:["update:scale","onScale","onMove"],setup(c,{expose:y,emit:t}){const d=c,n=e.ref(z(T,d)),g=t,l=e.ref(null),{containerInfo:u,containerStyle:i}=Z(n,l),{transformInfo:o}=ee(n,u),{boundaryInfo:f}=ne(n,u,o),{scrollBarInfo:r}=te(n,u,o),m=e.reactive({});e.watch(()=>o.scale,S=>{if(S){if(!m.scale){const w={scale:S,translateX:o.translateX,translateY:o.translateY};Object.assign(m,w)}g("update:scale",S)}}),e.watch(()=>d,()=>{n.value=z(n.value,d)},{deep:!0});function s(S){g("onScale",S)}function v(S,w){g("onMove",S,w)}function x(S){X(n,u,o,S,s)}e.watch(()=>n.value.scale,S=>{S!==o.scale&&x(S)}),oe(n,u,o);const L=e.reactive({});re(n,u,o,f,l,r,L,s,v);function a(){Object.assign(o,m)}const p=e.ref(null),h=e.ref(null);function M(){n.value.useRuler&&(p.value&&p.value.removeAllPositionLine(),h.value&&h.value.removeAllPositionLine())}function b(S=!0){n.value.useRuler&&(p.value&&p.value.toggleRuler(S),h.value&&h.value.toggleRuler(S))}function O(S=!0){n.value.useRuler&&(p.value&&p.value.togglePositionLine(S),h.value&&h.value.togglePositionLine(S))}function C(S,w=!0,B=!1){n.value.useRuler&&(B&&p.value&&p.value.modifyAdsorptionList(S,w),!B&&h.value&&h.value.modifyAdsorptionList(S,w))}return y({reset:a,changeScale:x,removeAllPositionLine:M,showRuler(){b()},hideRuler(){b(!1)},showAllPositionLine(){O()},hideAllPositionLine(){O(!1)},addAdsorptionLine(S,w=!1){C(S,!0,w)},removeAdsorptionLine(S,w=!1){C(S,!1,w)}}),(S,w)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"container",ref:l,style:e.normalizeStyle(e.unref(i))},[n.value.useRuler?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(k,{ref_key:"xRuler",ref:p,opt:n.value,"container-info":e.unref(u),"transform-info":e.unref(o)},null,8,["opt","container-info","transform-info"]),e.createVNode(k,{ref_key:"yRuler",ref:h,"is-y":"",opt:n.value,"container-info":e.unref(u),"transform-info":e.unref(o)},null,8,["opt","container-info","transform-info"])],64)):e.createCommentVNode("",!0),e.createVNode(E,{"container-info":e.unref(u),opt:n.value,"transform-info":e.unref(o)},{default:e.withCtx(()=>[e.renderSlot(S.$slots,"default")]),_:3},8,["container-info","opt","transform-info"]),e.unref(r).isXLarge?(e.openBlock(),e.createBlock(P,{key:1,opt:n.value,"container-info":e.unref(u),"scroll-bar-info":e.unref(r),"global-info":L,"transform-info":e.unref(o),onOnMove:v},null,8,["opt","container-info","scroll-bar-info","global-info","transform-info"])):e.createCommentVNode("",!0),e.unref(r).isYLarge?(e.openBlock(),e.createBlock(P,{key:2,opt:n.value,"container-info":e.unref(u),"scroll-bar-info":e.unref(r),"global-info":L,"transform-info":e.unref(o),onOnMove:v,"is-y":""},null,8,["opt","container-info","scroll-bar-info","global-info","transform-info"])):e.createCommentVNode("",!0)],4))}})});
