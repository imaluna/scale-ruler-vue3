"use strict";const t=require("vue"),I=t.defineComponent({__name:"CanvasPanel",props:{containerInfo:{type:Object,required:!0},opt:{type:Object,required:!0},transformInfo:{type:Object,required:!0}},setup(c){const g=c,e=t.computed(()=>{var d,n;return{position:"absolute",left:0,top:0,width:((d=g.opt)==null?void 0:d.canvasWidth)+"px",height:((n=g.opt)==null?void 0:n.canvasHeight)+"px",transition:"transform 300ms",transformOrigin:"0 0",transform:`translate(${g.transformInfo.translateX}px, ${g.transformInfo.translateY}px) scale(${g.transformInfo.scale})`,...g.opt.canvasStyle}});return(d,n)=>(t.openBlock(),t.createElementBlock("div",{ref:"canvasPanel",style:t.normalizeStyle(e.value)},null,4))}}),P=t.defineComponent({__name:"ScrollBar",props:{containerInfo:{type:Object,required:!0},opt:{type:Object,required:!0},isY:{type:Boolean,default:!1},scrollBarInfo:{type:Object,required:!0},globalInfo:{type:Object,required:!0},transformInfo:{type:Object,required:!0}},emits:["onMove"],setup(c,{emit:g}){const e=c,d=g,{globalInfo:n,transformInfo:m}=t.toRefs(e),l=t.computed(()=>{const{opt:f,scrollBarInfo:r,isY:h}=e,{scrollBarConfig:s}=f,y={position:"absolute",borderRadius:"4px",backgroundColor:s.bgColor,opacity:e.globalInfo[h?"yOpacity":"xOpacity"]||0,transition:"opacity 300ms",cursor:"pointer",zIndex:s.zIndex,width:(h?s.barSize:r.width)+"px",height:(h?r.height:s.barSize)+"px"};return h?(y.top=r.top+"px",y.right=0):(y.left=r.left+"px",y.bottom=0),y}),u=t.ref(null),i={};function o(f){if(f.preventDefault(),!n.value.scrollBarMouseDown)return;let{translateX:r,translateY:h}=m.value;const s=e.scrollBarInfo,{width:y,height:x}=e.containerInfo;if(e.isY){const L=f.pageY-i.startY;let a=i.top+L;a=Math.min(Math.max(0,a),x-s.height);const p=a*s.totalHeight/x;h=e.opt.containerYPadding-p,m.value.translateY=h}else{const L=f.pageX-i.startX;let a=i.left+L;a=Math.min(Math.max(0,a),y-s.width);const p=a*s.totalWidth/y;r=e.opt.containerXPadding-p,m.value.translateX=r}d("onMove",m.value.translateX,m.value.translateY)}return t.onMounted(()=>{if(u.value){const f=u.value,r=e.isY?"yOpacity":"xOpacity";f.addEventListener("mouseenter",()=>{n.value[r]=e.opt.scrollBarConfig.opacity,n.value[e.isY?"xOpacity":"yOpacity"]=0,n.value.scrollBarEnter=!0}),f.addEventListener("mouseleave",()=>{n.value.scrollBarMouseDown||(n.value.scrollBarEnter=!1,n.value[r]=0)}),f.addEventListener("mousedown",h=>{h.preventDefault(),n.value.scrollBarMouseDown=!0,i.startX=h.pageX,i.startY=h.pageY,i.left=e.scrollBarInfo.left,i.top=e.scrollBarInfo.top,document.addEventListener("mousemove",o)}),document.addEventListener("mouseup",()=>{n.value.scrollBarMouseDown&&(n.value.scrollBarMouseDown=!1,document.removeEventListener("mousemove",o))})}}),(f,r)=>(t.openBlock(),t.createElementBlock("div",{ref_key:"scrollBarRef",ref:u,style:t.normalizeStyle(l.value)},null,4))}}),H=c=>c<=.25?40:c<=.5?20:c<=1?10:c<=2?5:c<=4?2:1,D=c=>{const g=c.getBoundingClientRect(),e=g.top+(document.body.scrollTop||document.documentElement.scrollTop),d=g.left+(document.body.scrollLeft||document.documentElement.scrollLeft);return{top:e,left:d}},_=(c,g,e)=>{const{scale:d,translateX:n,translateY:m}=c;return(g-(e?m:n))/d},Y=(c,g,e)=>{const{scale:d,translateX:n,translateY:m}=c,l=g*d;return(e?m:n)+l};function W(c,g,e,d,n,m){const l={coordinate:n,translate:d},u=c.length;if(u>0){let i=0;for(;i<u;){const o=c[i];if(Math.abs(n-o)<=e){l.coordinate=o,l.translate=Y(g,o,m);break}else if(o>n)break;i++}}return l}const q=(c,g,e,d)=>{t.nextTick(()=>{const n=d.value;if(n){const m=n.offsetWidth,l=n.offsetHeight,{rulerConfig:u}=c,{bgColor:i,fontFamily:o,fontSize:f,lineColor:r,fontColor:h}=u;if(m>0&&l>0){const s=n.getContext("2d");s.clearRect(0,0,m,l),i&&(s.save(),s.fillStyle=i,s.fillRect(0,0,m,l),s.restore());const y=e?u.yRulerWidth:u.xRulerHeight,{translateX:x,translateY:L,scale:a}=g,p=e?L:x,v=H(a),M=v*a,b=window.devicePixelRatio,O=-p,C=Math.floor(O/M),S=Math.floor(((e?l:m)-p)/M);s.save(),s.fillStyle=r,s.font=`${f*b}px ${o}`,s.translate(.5,.5),s.scale(1/b,1/b),e?s.fillRect((y-1)*b,0,1,l*b):s.fillRect(0,(y-1)*b,m*b,1);for(let w=C;w<=S;w++){s.fillStyle=r;const B=(p+w*M)*b;let R=y/4;w%10===0?R=y*4/5:w%5===0&&(R=y/3),e?s.fillRect((y-R)*b,B,R*b,1):(s.fillRect(B,(y-R)*b,1,R*b),w%10===0&&(s.fillStyle=h,s.fillText(String(w*v),B+2*b,(y+8-R)*b)))}if(s.restore(),e){s.font=`${f}px ${o}`;let w=C;for(;w<=S;)if(w%10)w++;else{s.save();const B=p+w*M+y/2;s.translate(B+y/5,B-y*6/5),s.rotate(Math.PI/2),s.fillText(String(w*v),y*4/5,B),w+=10,s.restore()}}}}})},$=(c,g)=>{const e=t.reactive([0]);function d(o,f=!0){const r=e.indexOf(o);f&&r===-1&&e.push(o),!f&&r>-1&&e.splice(r,1),f&&e.sort((h,s)=>h-s)}function n(o,f=!0){Array.isArray(o)?o.forEach(r=>d(r,f)):d(o,f)}function m(o){n(o)}function l(o){n(o,!1)}const u=t.computed(()=>c.positionLineConfig[g?"adsorptionYList":"adsorptionXList"]);t.watch(()=>u.value,o=>{m(o)},{deep:!0});const i=t.computed(()=>g?c.canvasWidth:c.canvasHeight);return t.watch(()=>i.value,(o,f)=>{f!==void 0&&l(f),m(o)},{immediate:!0}),{adsorptionList:e,modifyAdsorptionList:n}},F=(c,g,e,d,n,m)=>{let l=1;const u=t.reactive([]);let i=-1,o=!1;function f(r){if(o&&i>-1){r.preventDefault();const{xRulerHeight:h,yRulerWidth:s}=c.value.rulerConfig,y=u[i],x=(n?r.pageY:r.pageX)-y.start,L=y.startTranslate+x,a=L>(n?h:s),p=_(d.value,L,n),v=W(e,d.value,c.value.positionLineConfig.adsorptionGap,L,p,n);u[i].showTip=a,u[i].coordinate=v.coordinate}}return t.onMounted(()=>{if(m.value){const r=m.value;r.addEventListener("mousedown",h=>{const s=D(r),y=n?h.pageY:h.pageX,x=y-(n?s.top:s.left),L={startTranslate:x,start:y,id:l,coordinate:_(d.value,x,n),showTip:!1,show:!0,needAnimate:!1};i=l,u[l++]=L,o=!0,document.addEventListener("mousemove",f)}),document.addEventListener("mouseup",()=>{if(document.removeEventListener("mousemove",f),!o||i<0)return;o=!1;const h=u[i],{width:s,height:y}=g.value,{xRulerHeight:x,yRulerWidth:L}=c.value.rulerConfig;h.translate<=(n?x:L)||h.translate>=(n?y:s)?delete u[i]:(u[i].showTip=!1,u[i].needAnimate=!0),i=-1})}}),{positionLineMap:u}},N=(c,g,e,d,n,m,l,u)=>{let i=!1;function o(r){l.value.showTip=r}function f(r){if(!i)return;const h=(n?r.pageY:r.pageX)-l.value.start,s=l.value.startTranslate+h,y=_(d.value,s,n),x=W(e.value,d.value,c.value.positionLineConfig.adsorptionGap,s,y,n);l.value.coordinate=x.coordinate}t.onMounted(()=>{if(m.value){const r=m.value;r.addEventListener("mouseenter",()=>{o(!0)}),r.addEventListener("mouseleave",()=>{console.log({isMouseDown:i}),i||o(!1)}),r.addEventListener("mousedown",h=>{h.preventDefault(),i=!0,l.value.showTip=!0;const s=n?h.pageY:h.pageX;l.value.start=s,l.value.startTranslate=Y(d.value,l.value.coordinate,n),l.value.needAnimate=!1,document.addEventListener("mousemove",f)}),document.addEventListener("mouseup",()=>{if(!i)return;i=!1;const{translate:h,id:s}=l.value,{width:y,height:x}=g.value,{xRulerHeight:L,yRulerWidth:a}=c.value.rulerConfig;h<=(n?L:a)||h>=(n?x:y)?u(s):(o(!1),l.value.needAnimate=!0),document.removeEventListener("mousemove",f)})}})},K=t.defineComponent({__name:"PositionLine",props:{containerInfo:{type:Object,required:!0},opt:{type:Object,required:!0},isY:{type:Boolean,default:!1},transformInfo:{type:Object,required:!0},lineInfo:{type:Object,required:!0},adsorptionList:{type:Array,required:!0}},emits:["remove-position-line"],setup(c,{emit:g}){const e=c,{lineInfo:d,adsorptionList:n,transformInfo:m,opt:l,containerInfo:u}=t.toRefs(e),i=t.computed(()=>l.value.positionLineConfig.padding),o=t.computed(()=>2*i.value+1),f=t.computed(()=>Y(m.value,d.value.coordinate,e.isY)),r=t.computed(()=>{const{width:v,height:M}=u.value,{isY:b}=e,O=b?`translate(0, ${f.value}px)`:`translate(${f.value}px, 0)`;return{display:d.value.show?"block":"none",position:"absolute",width:(b?v:o.value)+"px",height:(b?o.value:M)+"px",cursor:b?"row-resize":"col-resize",top:(b?-i.value:0)+"px",left:(b?0:-i.value)+"px",transform:O,zIndex:e.opt.positionLineConfig.zIndex,transition:d.value.needAnimate?"transform 300ms":""}}),h=t.computed(()=>{const{isY:v}=e;return{position:"absolute",width:v?"100%":"1px",height:v?"1px":"100%",backgroundColor:l.value.positionLineConfig.lineColor,top:(v?i.value:0)+"px",left:(v?0:i.value)+"px"}}),s=t.ref({}),y=t.computed(()=>{const{isY:v}=e,{width:M,height:b}=u.value,{tipWidth:O,tipHeight:C}=s.value;let S,w;return O&&C?(w=v?"50%":(f.value+o.value+O>=M?-O:o.value)+"px",S=v?(f.value+o.value+C>=b?-C:o.value)+"px":"50%"):(w=v?"50%":o.value+"px",S=v?o.value+"px":"50%"),{position:"absolute",padding:"5px",lineHeight:"18px",minWidth:"80px",backgroundColor:"rgba(0,0,0,.8)",color:"#fff",fontSize:"12px",borderRadius:"4px",userSelect:"none",textAlign:"center",left:w,top:S,transform:v?"translate(-50%, 0)":"translate(0, -50%)",visibility:d.value.showTip?"visible":"hidden"}}),x=t.ref(null),L=g;function a(v){L("remove-position-line",v)}N(l,u,n,m,e.isY,x,d,a);const p=t.ref(null);return t.onMounted(()=>{if(p.value){const v=p.value,M=v.offsetWidth,b=v.offsetHeight;s.value.tipWidth=M,s.value.tipHeight=b}}),(v,M)=>(t.openBlock(),t.createElementBlock("div",{ref_key:"positionLineRef",ref:x,class:"scale-ruler_position-line",style:t.normalizeStyle(r.value)},[t.createElementVNode("div",{class:"scale-ruler_position-line_inner",style:t.normalizeStyle(h.value)},null,4),t.createElementVNode("div",{class:"scale-ruler_position-line_tip",style:t.normalizeStyle(y.value),ref_key:"tipRef",ref:p},t.toDisplayString((c.isY?"Y":"X")+": "+ +t.unref(d).coordinate.toFixed(2)+" px"),5)],4))}}),V=["width","height"],T=t.defineComponent({__name:"Ruler",props:{containerInfo:{type:Object,required:!0},opt:{type:Object,required:!0},isY:{type:Boolean,default:!1},transformInfo:{type:Object,required:!0}},setup(c,{expose:g}){const e=c,{opt:d,transformInfo:n,containerInfo:m}=t.toRefs(e),l=t.computed(()=>{const{isY:a,containerInfo:p,opt:v}=e;return{width:a?v.rulerConfig.yRulerWidth:p.width,height:a?p.height:v.rulerConfig.xRulerHeight}}),u=t.computed(()=>({position:"absolute",left:0,top:0,zIndex:e.opt.rulerConfig.zIndex+(e.isY?0:1)})),i=t.ref();t.watch([()=>e.containerInfo,()=>e.transformInfo],()=>{q(e.opt,e.transformInfo,e.isY,i)},{deep:!0});const{adsorptionList:o,modifyAdsorptionList:f}=$(e.opt,e.isY),{positionLineMap:r}=F(d,m,o,n,!e.isY,i);function h(a){delete r[a]}function s(){Object.keys(r).forEach(a=>{h(a)})}function y(a=!0){Object.keys(r).forEach(p=>{r[p].show=a})}const x=t.ref(!0);function L(a=!0){x.value=a,y(a)}return g({modifyAdsorptionList:f,removeAllPositionLine:s,togglePositionLine:y,toggleRuler:L}),(a,p)=>(t.openBlock(),t.createElementBlock(t.Fragment,null,[t.withDirectives(t.createElementVNode("canvas",{ref_key:"rulerRef",ref:i,style:t.normalizeStyle(u.value),width:l.value.width,height:l.value.height},null,12,V),[[t.vShow,x.value]]),e.opt.usePositionLine?(t.openBlock(),t.createElementBlock("div",{key:0,class:t.normalizeClass("position-line-"+(e.isY?"x":"y"))},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(Object.keys(t.unref(r)),v=>(t.openBlock(),t.createBlock(K,{key:v,opt:e.opt,"is-y":!e.isY,"transform-info":e.transformInfo,"container-info":e.containerInfo,"line-info":t.unref(r)[v],"adsorption-list":t.unref(o),onRemovePositionLine:h},null,8,["opt","is-y","transform-info","container-info","line-info","adsorption-list"]))),128))],2)):t.createCommentVNode("",!0)],64))}});function G(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var E,A;function U(){if(A)return E;A=1;var c=function(p){return g(p)&&!e(p)};function g(a){return!!a&&typeof a=="object"}function e(a){var p=Object.prototype.toString.call(a);return p==="[object RegExp]"||p==="[object Date]"||m(a)}var d=typeof Symbol=="function"&&Symbol.for,n=d?Symbol.for("react.element"):60103;function m(a){return a.$$typeof===n}function l(a){return Array.isArray(a)?[]:{}}function u(a,p){return p.clone!==!1&&p.isMergeableObject(a)?x(l(a),a,p):a}function i(a,p,v){return a.concat(p).map(function(M){return u(M,v)})}function o(a,p){if(!p.customMerge)return x;var v=p.customMerge(a);return typeof v=="function"?v:x}function f(a){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(a).filter(function(p){return Object.propertyIsEnumerable.call(a,p)}):[]}function r(a){return Object.keys(a).concat(f(a))}function h(a,p){try{return p in a}catch{return!1}}function s(a,p){return h(a,p)&&!(Object.hasOwnProperty.call(a,p)&&Object.propertyIsEnumerable.call(a,p))}function y(a,p,v){var M={};return v.isMergeableObject(a)&&r(a).forEach(function(b){M[b]=u(a[b],v)}),r(p).forEach(function(b){s(a,b)||(h(a,b)&&v.isMergeableObject(p[b])?M[b]=o(b,v)(a[b],p[b],v):M[b]=u(p[b],v))}),M}function x(a,p,v){v=v||{},v.arrayMerge=v.arrayMerge||i,v.isMergeableObject=v.isMergeableObject||c,v.cloneUnlessOtherwiseSpecified=u;var M=Array.isArray(p),b=Array.isArray(a),O=M===b;return O?M?v.arrayMerge(a,p,v):y(a,p,v):u(p,v)}x.all=function(p,v){if(!Array.isArray(p))throw new Error("first argument should be an array");return p.reduce(function(M,b){return x(M,b,v)},{})};var L=x;return E=L,E}var J=U();const k=G(J),j={scale:1,canScale:!0,maxScale:10,minScale:.1,autoCenter:!0,autoScale:!0,containerAutoSize:!1,containerWidth:1e3,containerHeight:500,containerXPadding:80,containerYPadding:80,canvasWidth:1920,canvasHeight:1e3,proxyScaleKey:!0,useScrollBar:!0,useRuler:!0,usePositionLine:!0,positionLineConfig:{lineColor:"#24aa61",padding:3,adsorptionXList:[],adsorptionYList:[],adsorptionGap:4,zIndex:300},canvasStyle:{},scrollBarConfig:{bgColor:"#000000",opacity:.4,zIndex:500,barSize:8},rulerConfig:{yRulerWidth:30,xRulerHeight:30,bgColor:"#efefef",fontColor:"#000000",fontSize:12,fontFamily:"Arial",lineColor:"#000000",zIndex:400},onScale:()=>{},onMove:()=>{}},Q=function(){const c={};for(const g in j){const e=j[g];typeof e=="object"&&e!==null?c[g]=()=>e:c[g]=e}return c}(),Z=(c,g)=>{const e=t.reactive({width:0,height:0,originWidth:0,originHeight:0});function d(u,i){new ResizeObserver(f=>{for(const r of f)if(r.target===i){const h=i.offsetWidth,s=i.offsetHeight;(h!==e.originWidth||s!==e.originHeight)&&n(u,i)}}).observe(i)}function n(u,i,o=!1){const f=u.value;f.containerAutoSize?(e.width=i.offsetWidth,e.height=i.offsetHeight,e.originWidth=e.width,e.originHeight=e.height,o&&d(u,i)):(e.width=f.containerWidth,e.height=f.containerHeight);const r=getComputedStyle(i);r.boxSizing==="border-box"&&(e.width-=parseFloat(r.borderLeftWidth)+parseFloat(r.borderRightWidth),e.height-=parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth)),r.position==="static"&&(e.position="relative")}t.onMounted(()=>{const u=g.value;u&&n(c,u,!0)});const m=t.computed(()=>({width:e.width,height:e.height})),l=t.computed(()=>{const u=c.value,i={overflow:"hidden"};return u.containerAutoSize||(i.width=e.width+"px",i.height=e.height+"px"),e.position&&(i.position=e.position),i});return{containerInfo:m,containerStyle:l}},ee=(c,g)=>{const e=t.reactive({});return t.watch(()=>g.value,()=>{const d=c.value;let n=0,m=0,{scale:l}=d;const{autoCenter:u,autoScale:i}=d,{width:o,height:f}=g.value;if(i){const s=(o-2*d.containerXPadding)/d.canvasWidth,y=(f-2*d.containerYPadding)/d.canvasHeight;l=Math.min(s,y)}e.scale=l;let r=0,h=0;n=d.canvasWidth*l,m=d.canvasHeight*l,u&&(r=Math.floor((o-n)/2),h=Math.floor((f-m)/2),e.translateX=r,e.translateY=h)},{deep:!0}),{transformInfo:e}},te=(c,g,e)=>({scrollBarInfo:t.computed(()=>{const n=c.value,{width:m,height:l}=g.value,{translateX:u,translateY:i,scale:o}=e,f=n.canvasWidth*o+2*n.containerXPadding,r=n.canvasHeight*o+2*n.containerYPadding,h=m<f,s=l<r,y=h||s,x=m*((n.containerXPadding-u)/f),L=l*((n.containerYPadding-i)/r),a=m/f*m,p=l/r*l;return{totalHeight:r,totalWidth:f,left:x,top:L,width:a,height:p,isYLarge:s,isXLarge:h,isLarge:y}})});function z(c,g,e){const d=c.value,{containerXPadding:n,containerYPadding:m,canvasWidth:l,canvasHeight:u}=d,i=l*e,o=u*e,{width:f,height:r}=g.value,h=Math.max((f-i)/2,n),s=Math.max((r-o)/2,m),y=i+2*n>f?f-(i+n):h,x=o+2*m>r?r-(o+m):s;return{maxTranslateX:h,maxTranslateY:s,minTranslateX:y,minTranslateY:x}}const ne=(c,g,e)=>({boundaryInfo:t.computed(()=>z(c,g,e.scale))}),X=(c,g,e,d,n)=>{const m=c.value;let{translateX:l,translateY:u,scale:i}=e;d=Math.min(Math.max(d,m.minScale),m.maxScale);const o=d-i,f=z(c,g,d);l-=o*m.canvasWidth/2,u-=o*m.canvasHeight/2,l=Math.max(Math.min(l,f.maxTranslateX),f.minTranslateX),u=Math.max(Math.min(u,f.maxTranslateY),f.minTranslateY),e.scale=d,e.translateX=l,e.translateY=u,n(d)},oe=(c,g,e)=>{c.value.proxyScaleKey&&document.addEventListener("keydown",d=>{if(c.value.canScale){const n=d.keyCode;if((d.metaKey||d.ctrlKey)&&(n===187||n===189)){d.preventDefault();const m=e.scale+(n===187?.05:-.05);X(c,g,e,m)}}})},re=(c,g,e,d,n,m,l,u,i)=>{let o=null;Object.assign(l,{xOpacity:0,yOpacity:0,scrollBarMouseDown:!1,scrollBarEnter:!1}),t.onMounted(()=>{n.value&&n.value.addEventListener("wheel",f=>{if(c.value.canScale)if(f.metaKey||f.ctrlKey){f.preventDefault();const r=-1*f.deltaY/100,h=e.scale+r;X(c,g,e,h,u)}else{if(!m.value.isLarge||l.scrollBarMouseDown)return;f.preventDefault();let{translateX:r,translateY:h}=e;o&&clearTimeout(o);const s=-f.deltaX,y=-f.deltaY;let x="";const{opacity:L=.4}=c.value.scrollBarConfig,{isXLarge:a,isYLarge:p}=m.value,{maxTranslateX:v,minTranslateX:M,maxTranslateY:b,minTranslateY:O}=d.value;a&&Math.abs(s)>Math.abs(y)&&(r+=s,r=Math.max(Math.min(r,v),M),l.xOpacity=L,l.yOpacity=0,e.translateX=r,x="x"),p&&Math.abs(y)>Math.abs(s)&&(x="y",h+=y,h=Math.max(Math.min(h,b),O),l.yOpacity=L,l.xOpacity=0,e.translateY=h),x&&(i(e.translateX,e.translateY),o=setTimeout(()=>{l.scrollBarEnter||(l[x==="y"?"yOpacity":"xOpacity"]=0)},1e3))}})})},ae=t.defineComponent({__name:"index",props:t.mergeDefaults({scale:{},minScale:{},maxScale:{},canScale:{type:Boolean},autoCenter:{type:Boolean},autoScale:{type:Boolean},containerAutoSize:{type:Boolean},containerWidth:{},containerHeight:{},containerXPadding:{},containerYPadding:{},canvasWidth:{},canvasHeight:{},proxyScaleKey:{type:Boolean},useScrollBar:{type:Boolean},useRuler:{type:Boolean},usePositionLine:{type:Boolean},positionLineConfig:{},canvasStyle:{},scrollBarConfig:{},rulerConfig:{},onScale:{type:Function},onMove:{type:Function}},Q),emits:["update:scale","onScale","onMove"],setup(c,{expose:g,emit:e}){const d=c,n=t.ref(k(j,d)),m=e,l=t.ref(null),{containerInfo:u,containerStyle:i}=Z(n,l),{transformInfo:o}=ee(n,u),{boundaryInfo:f}=ne(n,u,o),{scrollBarInfo:r}=te(n,u,o),h=t.reactive({});t.watch(()=>o.scale,S=>{if(S){if(!h.scale){const w={scale:S,translateX:o.translateX,translateY:o.translateY};Object.assign(h,w)}m("update:scale",S)}}),t.watch(()=>d,()=>{n.value=k(n.value,d)},{deep:!0});function s(S){m("onScale",S)}function y(S,w){m("onMove",S,w)}function x(S){X(n,u,o,S,s)}t.watch(()=>n.value.scale,S=>{S!==o.scale&&x(S)}),oe(n,u,o);const L=t.reactive({});re(n,u,o,f,l,r,L,s,y);function a(){Object.assign(o,h)}const p=t.ref(null),v=t.ref(null);function M(){n.value.useRuler&&(p.value&&p.value.removeAllPositionLine(),v.value&&v.value.removeAllPositionLine())}function b(S=!0){n.value.useRuler&&(p.value&&p.value.toggleRuler(S),v.value&&v.value.toggleRuler(S))}function O(S=!0){n.value.useRuler&&(p.value&&p.value.togglePositionLine(S),v.value&&v.value.togglePositionLine(S))}function C(S,w=!0,B=!1){n.value.useRuler&&(B&&p.value&&p.value.modifyAdsorptionList(S,w),!B&&v.value&&v.value.modifyAdsorptionList(S,w))}return g({reset:a,changeScale:x,removeAllPositionLine:M,showRuler(){b()},hideRuler(){b(!1)},showAllPositionLine(){O()},hideAllPositionLine(){O(!1)},addAdsorptionLine(S,w=!1){C(S,!0,w)},removeAdsorptionLine(S,w=!1){C(S,!1,w)}}),(S,w)=>(t.openBlock(),t.createElementBlock("div",{ref_key:"container",ref:l,style:t.normalizeStyle(t.unref(i))},[n.value.useRuler?(t.openBlock(),t.createElementBlock(t.Fragment,{key:0},[t.createVNode(T,{ref_key:"xRuler",ref:p,opt:n.value,"container-info":t.unref(u),"transform-info":t.unref(o)},null,8,["opt","container-info","transform-info"]),t.createVNode(T,{ref_key:"yRuler",ref:v,"is-y":"",opt:n.value,"container-info":t.unref(u),"transform-info":t.unref(o)},null,8,["opt","container-info","transform-info"])],64)):t.createCommentVNode("",!0),t.createVNode(I,{"container-info":t.unref(u),opt:n.value,"transform-info":t.unref(o)},{default:t.withCtx(()=>[t.renderSlot(S.$slots,"default")]),_:3},8,["container-info","opt","transform-info"]),t.unref(r).isXLarge?(t.openBlock(),t.createBlock(P,{key:1,opt:n.value,"container-info":t.unref(u),"scroll-bar-info":t.unref(r),"global-info":L,"transform-info":t.unref(o),onOnMove:y},null,8,["opt","container-info","scroll-bar-info","global-info","transform-info"])):t.createCommentVNode("",!0),t.unref(r).isYLarge?(t.openBlock(),t.createBlock(P,{key:2,opt:n.value,"container-info":t.unref(u),"scroll-bar-info":t.unref(r),"global-info":L,"transform-info":t.unref(o),onOnMove:y,"is-y":""},null,8,["opt","container-info","scroll-bar-info","global-info","transform-info"])):t.createCommentVNode("",!0)],4))}});module.exports=ae;
