"use strict";const e=require("vue"),I=e.defineComponent({__name:"CanvasPanel",props:{containerInfo:{type:Object,required:!0},opt:{type:Object,required:!0},transformInfo:{type:Object,required:!0}},setup(l){const d=l,t=e.computed(()=>{var c,o;return{position:"absolute",left:0,top:0,width:((c=d.opt)==null?void 0:c.canvasWidth)+"px",height:((o=d.opt)==null?void 0:o.canvasHeight)+"px",transition:"transform 300ms",transformOrigin:"0 0",transform:`translate(${d.transformInfo.translateX}px, ${d.transformInfo.translateY}px) scale(${d.transformInfo.scale})`,...d.opt.canvasStyle}});return(c,o)=>(e.openBlock(),e.createElementBlock("div",{ref:"canvasPanel",style:e.normalizeStyle(t.value)},null,4))}}),T=e.defineComponent({__name:"ScrollBar",props:{containerInfo:{type:Object,required:!0},opt:{type:Object,required:!0},isY:{type:Boolean,default:!1},scrollBarInfo:{type:Object,required:!0},globalInfo:{type:Object,required:!0},transformInfo:{type:Object,required:!0}},setup(l){const d=l,{globalInfo:t,transformInfo:c}=e.toRefs(d),o=e.computed(()=>{const{opt:r,scrollBarInfo:n,isY:p}=d,{scrollBarConfig:s}=r,g={position:"absolute",borderRadius:"4px",backgroundColor:s.bgColor,opacity:d.globalInfo[p?"yOpacity":"xOpacity"]||0,transition:"opacity 300ms",cursor:"pointer",zIndex:s.zIndex,width:(p?s.barSize:n.width)+"px",height:(p?n.height:s.barSize)+"px"};return p?(g.top=n.top+"px",g.right=0):(g.left=n.left+"px",g.bottom=0),g}),m=e.ref(null),a={};function u(r){if(r.preventDefault(),!t.value.scrollBarMouseDown)return;let{translateX:n,translateY:p}=c.value;const s=d.scrollBarInfo,{width:g,height:f}=d.containerInfo;if(d.isY){const y=r.pageY-a.startY;let x=a.top+y;x=Math.min(Math.max(0,x),f-s.height);const w=x*s.totalHeight/f;p=d.opt.containerYPadding-w,c.value.translateY=p}else{const y=r.pageX-a.startX;let x=a.left+y;x=Math.min(Math.max(0,x),g-s.width);const w=x*s.totalWidth/g;n=d.opt.containerXPadding-w,c.value.translateX=n}}return e.onMounted(()=>{if(m.value){const r=m.value,n=d.isY?"yOpacity":"xOpacity";r.addEventListener("mouseenter",()=>{t.value[n]=d.opt.scrollBarConfig.opacity,t.value[d.isY?"xOpacity":"yOpacity"]=0,t.value.scrollBarEnter=!0}),r.addEventListener("mouseleave",()=>{t.value.scrollBarMouseDown||(t.value.scrollBarEnter=!1,t.value[n]=0)}),r.addEventListener("mousedown",p=>{p.preventDefault(),t.value.scrollBarMouseDown=!0,a.startX=p.pageX,a.startY=p.pageY,a.left=d.scrollBarInfo.left,a.top=d.scrollBarInfo.top,document.addEventListener("mousemove",u)}),document.addEventListener("mouseup",()=>{t.value.scrollBarMouseDown&&(t.value.scrollBarMouseDown=!1,document.removeEventListener("mousemove",u))})}}),(r,n)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"scrollBarRef",ref:m,style:e.normalizeStyle(o.value)},null,4))}}),H=l=>l<=.25?40:l<=.5?20:l<=1?10:l<=2?5:l<=4?2:1,D=l=>{const d=l.getBoundingClientRect(),t=d.top+(document.body.scrollTop||document.documentElement.scrollTop),c=d.left+(document.body.scrollLeft||document.documentElement.scrollLeft);return{top:t,left:c}},_=(l,d,t)=>{const{scale:c,translateX:o,translateY:m}=l;return(d-(t?m:o))/c},P=(l,d,t)=>{const{scale:c,translateX:o,translateY:m}=l,a=d*c;return(t?m:o)+a};function W(l,d,t,c,o,m){const a={coordinate:o,translate:c},u=l.length;if(u>0){let r=0;for(;r<u;){const n=l[r];if(Math.abs(o-n)<=t){a.coordinate=n,a.translate=P(d,n,m);break}else if(n>o)break;r++}}return a}const q=(l,d,t,c)=>{e.nextTick(()=>{const o=c.value;if(o){const m=o.offsetWidth,a=o.offsetHeight,{rulerConfig:u}=l,{bgColor:r,fontFamily:n,fontSize:p,lineColor:s,fontColor:g}=u;if(m>0&&a>0){const f=o.getContext("2d");f.clearRect(0,0,m,a),r&&(f.save(),f.fillStyle=r,f.fillRect(0,0,m,a),f.restore());const y=t?u.yRulerWidth:u.xRulerHeight,{translateX:x,translateY:w,scale:i}=d,h=t?w:x,v=H(i),S=v*i,b=window.devicePixelRatio,L=-h,B=Math.floor(L/S),M=Math.floor(((t?a:m)-h)/S);f.save(),f.fillStyle=s,f.font=`${p*b}px ${n}`,f.translate(.5,.5),f.scale(1/b,1/b),t?f.fillRect((y-1)*b,0,1,a*b):f.fillRect(0,(y-1)*b,m*b,1);for(let O=B;O<=M;O++){f.fillStyle=s;const C=(h+O*S)*b;let R=y/4;O%10===0?R=y*4/5:O%5===0&&(R=y/3),t?f.fillRect((y-R)*b,C,R*b,1):(f.fillRect(C,(y-R)*b,1,R*b),O%10===0&&(f.fillStyle=g,f.fillText(String(O*v),C+2*b,(y+8-R)*b)))}if(f.restore(),t){f.font=`${p}px ${n}`;let O=B;for(;O<=M;)if(O%10)O++;else{f.save();const C=h+O*S+y/2;f.translate(C+y/5,C-y*6/5),f.rotate(Math.PI/2),f.fillText(String(O*v),y*4/5,C),O+=10,f.restore()}}}}})},$=(l,d)=>{const t=e.reactive([0]);function c(n,p=!0){const s=t.indexOf(n);p&&s===-1&&t.push(n),!p&&s>-1&&t.splice(s,1),p&&t.sort((g,f)=>g-f)}function o(n,p=!0){Array.isArray(n)?n.forEach(s=>c(s,p)):c(n,p)}function m(n){o(n)}function a(n){o(n,!1)}const u=e.computed(()=>l.positionLineConfig[d?"adsorptionYList":"adsorptionXList"]);e.watch(()=>u.value,n=>{m(n)},{deep:!0});const r=e.computed(()=>d?l.canvasWidth:l.canvasHeight);return e.watch(()=>r.value,(n,p)=>{p!==void 0&&a(p),m(n)},{immediate:!0}),{adsorptionList:t,modifyAdsorptionList:o}},F=(l,d,t,c,o,m)=>{let a=1;const u=e.reactive([]);let r=-1,n=!1;function p(s){if(n&&r>-1){s.preventDefault();const{xRulerHeight:g,yRulerWidth:f}=l.value.rulerConfig,y=u[r],x=(o?s.pageY:s.pageX)-y.start,w=y.startTranslate+x,i=w>(o?g:f),h=_(c.value,w,o),v=W(t,c.value,l.value.positionLineConfig.adsorptionGap,w,h,o);u[r].showTip=i,u[r].coordinate=v.coordinate}}return e.onMounted(()=>{if(m.value){const s=m.value;s.addEventListener("mousedown",g=>{const f=D(s),y=o?g.pageY:g.pageX,x=y-(o?f.top:f.left),w={startTranslate:x,start:y,id:a,coordinate:_(c.value,x,o),showTip:!1,show:!0,needAnimate:!1};r=a,u[a++]=w,n=!0,document.addEventListener("mousemove",p)}),document.addEventListener("mouseup",()=>{if(document.removeEventListener("mousemove",p),!n||r<0)return;n=!1;const g=u[r],{width:f,height:y}=d.value,{xRulerHeight:x,yRulerWidth:w}=l.value.rulerConfig;g.translate<=(o?x:w)||g.translate>=(o?y:f)?delete u[r]:(u[r].showTip=!1,u[r].needAnimate=!0),r=-1})}}),{positionLineMap:u}},N=(l,d,t,c,o,m,a,u)=>{let r=!1;function n(s){a.value.showTip=s}function p(s){if(!r)return;const g=(o?s.pageY:s.pageX)-a.value.start,f=a.value.startTranslate+g,y=_(c.value,f,o),x=W(t.value,c.value,l.value.positionLineConfig.adsorptionGap,f,y,o);a.value.coordinate=x.coordinate}e.onMounted(()=>{if(m.value){const s=m.value;s.addEventListener("mouseenter",()=>{n(!0)}),s.addEventListener("mouseleave",()=>{console.log({isMouseDown:r}),r||n(!1)}),s.addEventListener("mousedown",g=>{g.preventDefault(),r=!0,a.value.showTip=!0;const f=o?g.pageY:g.pageX;a.value.start=f,a.value.startTranslate=P(c.value,a.value.coordinate,o),a.value.needAnimate=!1,document.addEventListener("mousemove",p)}),document.addEventListener("mouseup",()=>{if(!r)return;r=!1;const{translate:g,id:f}=a.value,{width:y,height:x}=d.value,{xRulerHeight:w,yRulerWidth:i}=l.value.rulerConfig;g<=(o?w:i)||g>=(o?x:y)?u(f):(n(!1),a.value.needAnimate=!0),document.removeEventListener("mousemove",p)})}})},K=e.defineComponent({__name:"PositionLine",props:{containerInfo:{type:Object,required:!0},opt:{type:Object,required:!0},isY:{type:Boolean,default:!1},transformInfo:{type:Object,required:!0},lineInfo:{type:Object,required:!0},adsorptionList:{type:Array,required:!0}},emits:["remove-position-line"],setup(l,{emit:d}){const t=l,{lineInfo:c,adsorptionList:o,transformInfo:m,opt:a,containerInfo:u}=e.toRefs(t),r=e.computed(()=>a.value.positionLineConfig.padding),n=e.computed(()=>2*r.value+1),p=e.computed(()=>P(m.value,c.value.coordinate,t.isY)),s=e.computed(()=>{const{width:v,height:S}=u.value,{isY:b}=t,L=b?`translate(0, ${p.value}px)`:`translate(${p.value}px, 0)`;return{display:c.value.show?"block":"none",position:"absolute",width:(b?v:n.value)+"px",height:(b?n.value:S)+"px",cursor:b?"row-resize":"col-resize",top:(b?-r.value:0)+"px",left:(b?0:-r.value)+"px",transform:L,zIndex:t.opt.positionLineConfig.zIndex,transition:c.value.needAnimate?"transform 300ms":""}}),g=e.computed(()=>{const{isY:v}=t;return{position:"absolute",width:v?"100%":"1px",height:v?"1px":"100%",backgroundColor:a.value.positionLineConfig.lineColor,top:(v?r.value:0)+"px",left:(v?0:r.value)+"px"}}),f=e.ref({}),y=e.computed(()=>{const{isY:v}=t,{width:S,height:b}=u.value,{tipWidth:L,tipHeight:B}=f.value;let M,O;return L&&B?(O=v?"50%":(p.value+n.value+L>=S?-L:n.value)+"px",M=v?(p.value+n.value+B>=b?-B:n.value)+"px":"50%"):(O=v?"50%":n.value+"px",M=v?n.value+"px":"50%"),{position:"absolute",padding:"5px",lineHeight:"18px",minWidth:"80px",backgroundColor:"rgba(0,0,0,.8)",color:"#fff",fontSize:"12px",borderRadius:"4px",userSelect:"none",textAlign:"center",left:O,top:M,transform:v?"translate(-50%, 0)":"translate(0, -50%)",visibility:c.value.showTip?"visible":"hidden"}}),x=e.ref(null),w=d;function i(v){w("remove-position-line",v)}N(a,u,o,m,t.isY,x,c,i);const h=e.ref(null);return e.onMounted(()=>{if(h.value){const v=h.value,S=v.offsetWidth,b=v.offsetHeight;f.value.tipWidth=S,f.value.tipHeight=b}}),(v,S)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"positionLineRef",ref:x,class:"scale-ruler_position-line",style:e.normalizeStyle(s.value)},[e.createElementVNode("div",{class:"scale-ruler_position-line_inner",style:e.normalizeStyle(g.value)},null,4),e.createElementVNode("div",{class:"scale-ruler_position-line_tip",style:e.normalizeStyle(y.value),ref_key:"tipRef",ref:h},e.toDisplayString((l.isY?"Y":"X")+": "+ +e.unref(c).coordinate.toFixed(2)+" px"),5)],4))}}),V=["width","height"],X=e.defineComponent({__name:"Ruler",props:{containerInfo:{type:Object,required:!0},opt:{type:Object,required:!0},isY:{type:Boolean,default:!1},transformInfo:{type:Object,required:!0}},setup(l,{expose:d}){const t=l,{opt:c,transformInfo:o,containerInfo:m}=e.toRefs(t),a=e.computed(()=>{const{isY:i,containerInfo:h,opt:v}=t;return{width:i?v.rulerConfig.yRulerWidth:h.width,height:i?h.height:v.rulerConfig.xRulerHeight}}),u=e.computed(()=>({position:"absolute",left:0,top:0,zIndex:t.opt.rulerConfig.zIndex+(t.isY?0:1)})),r=e.ref();e.watch([()=>t.containerInfo,()=>t.transformInfo],()=>{q(t.opt,t.transformInfo,t.isY,r)},{deep:!0});const{adsorptionList:n,modifyAdsorptionList:p}=$(t.opt,t.isY),{positionLineMap:s}=F(c,m,n,o,!t.isY,r);function g(i){delete s[i]}function f(){Object.keys(s).forEach(i=>{g(i)})}function y(i=!0){Object.keys(s).forEach(h=>{s[h].show=i})}const x=e.ref(!0);function w(i=!0){x.value=i,y(i)}return d({modifyAdsorptionList:p,removeAllPositionLine:f,togglePositionLine:y,toggleRuler:w}),(i,h)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("canvas",{ref_key:"rulerRef",ref:r,style:e.normalizeStyle(u.value),width:a.value.width,height:a.value.height},null,12,V),[[e.vShow,x.value]]),t.opt.usePositionLine?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass("position-line-"+(t.isY?"x":"y"))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(Object.keys(e.unref(s)),v=>(e.openBlock(),e.createBlock(K,{key:v,opt:t.opt,"is-y":!t.isY,"transform-info":t.transformInfo,"container-info":t.containerInfo,"line-info":e.unref(s)[v],"adsorption-list":e.unref(n),onRemovePositionLine:g},null,8,["opt","is-y","transform-info","container-info","line-info","adsorption-list"]))),128))],2)):e.createCommentVNode("",!0)],64))}});function G(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var E,A;function U(){if(A)return E;A=1;var l=function(h){return d(h)&&!t(h)};function d(i){return!!i&&typeof i=="object"}function t(i){var h=Object.prototype.toString.call(i);return h==="[object RegExp]"||h==="[object Date]"||m(i)}var c=typeof Symbol=="function"&&Symbol.for,o=c?Symbol.for("react.element"):60103;function m(i){return i.$$typeof===o}function a(i){return Array.isArray(i)?[]:{}}function u(i,h){return h.clone!==!1&&h.isMergeableObject(i)?x(a(i),i,h):i}function r(i,h,v){return i.concat(h).map(function(S){return u(S,v)})}function n(i,h){if(!h.customMerge)return x;var v=h.customMerge(i);return typeof v=="function"?v:x}function p(i){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(i).filter(function(h){return Object.propertyIsEnumerable.call(i,h)}):[]}function s(i){return Object.keys(i).concat(p(i))}function g(i,h){try{return h in i}catch{return!1}}function f(i,h){return g(i,h)&&!(Object.hasOwnProperty.call(i,h)&&Object.propertyIsEnumerable.call(i,h))}function y(i,h,v){var S={};return v.isMergeableObject(i)&&s(i).forEach(function(b){S[b]=u(i[b],v)}),s(h).forEach(function(b){f(i,b)||(g(i,b)&&v.isMergeableObject(h[b])?S[b]=n(b,v)(i[b],h[b],v):S[b]=u(h[b],v))}),S}function x(i,h,v){v=v||{},v.arrayMerge=v.arrayMerge||r,v.isMergeableObject=v.isMergeableObject||l,v.cloneUnlessOtherwiseSpecified=u;var S=Array.isArray(h),b=Array.isArray(i),L=S===b;return L?S?v.arrayMerge(i,h,v):y(i,h,v):u(h,v)}x.all=function(h,v){if(!Array.isArray(h))throw new Error("first argument should be an array");return h.reduce(function(S,b){return x(S,b,v)},{})};var w=x;return E=w,E}var J=U();const k=G(J),j={scale:1,canScale:!0,maxScale:10,minScale:.1,autoCenter:!0,autoScale:!0,containerAutoSize:!1,containerWidth:1e3,containerHeight:500,containerXPadding:80,containerYPadding:80,canvasWidth:1920,canvasHeight:1e3,proxyScaleKey:!0,useScrollBar:!0,useRuler:!0,usePositionLine:!0,positionLineConfig:{lineColor:"#24aa61",padding:3,adsorptionXList:[],adsorptionYList:[],adsorptionGap:4,zIndex:300},canvasStyle:{},scrollBarConfig:{bgColor:"#000000",opacity:.4,zIndex:500,barSize:8},rulerConfig:{yRulerWidth:30,xRulerHeight:30,bgColor:"#efefef",fontColor:"#000000",fontSize:12,fontFamily:"Arial",lineColor:"#000000",zIndex:400},onScale:()=>{},onMove:()=>{}},Q=function(){const l={};for(const d in j){const t=j[d];typeof t=="object"&&t!==null?l[d]=()=>t:l[d]=t}return l}(),Z=(l,d)=>{const t=e.reactive({width:0,height:0,originWidth:0,originHeight:0});function c(u,r){new ResizeObserver(p=>{for(const s of p)if(s.target===r){const g=r.offsetWidth,f=r.offsetHeight;(g!==t.originWidth||f!==t.originHeight)&&o(u,r)}}).observe(r)}function o(u,r,n=!1){const p=u.value;p.containerAutoSize?(t.width=r.offsetWidth,t.height=r.offsetHeight,t.originWidth=t.width,t.originHeight=t.height,n&&c(u,r)):(t.width=p.containerWidth,t.height=p.containerHeight);const s=getComputedStyle(r);s.boxSizing==="border-box"&&(t.width-=parseFloat(s.borderLeftWidth)+parseFloat(s.borderRightWidth),t.height-=parseFloat(s.borderTopWidth)+parseFloat(s.borderBottomWidth)),s.position==="static"&&(t.position="relative")}e.onMounted(()=>{const u=d.value;u&&o(l,u,!0)});const m=e.computed(()=>({width:t.width,height:t.height})),a=e.computed(()=>{const u=l.value,r={overflow:"hidden"};return u.containerAutoSize||(r.width=t.width+"px",r.height=t.height+"px"),t.position&&(r.position=t.position),r});return{containerInfo:m,containerStyle:a}},ee=(l,d)=>{const t=e.reactive({});return e.watch(()=>d.value,()=>{const c=l.value;let o=0,m=0,{scale:a}=c;const{autoCenter:u,autoScale:r}=c,{width:n,height:p}=d.value;if(r){const f=(n-2*c.containerXPadding)/c.canvasWidth,y=(p-2*c.containerYPadding)/c.canvasHeight;a=Math.min(f,y)}t.scale=a;let s=0,g=0;o=c.canvasWidth*a,m=c.canvasHeight*a,u&&(s=Math.floor((n-o)/2),g=Math.floor((p-m)/2),t.translateX=s,t.translateY=g)},{deep:!0}),{transformInfo:t}},te=(l,d,t)=>({scrollBarInfo:e.computed(()=>{const o=l.value,{width:m,height:a}=d.value,{translateX:u,translateY:r,scale:n}=t,p=o.canvasWidth*n+2*o.containerXPadding,s=o.canvasHeight*n+2*o.containerYPadding,g=m<p,f=a<s,y=g||f,x=m*((o.containerXPadding-u)/p),w=a*((o.containerYPadding-r)/s),i=m/p*m,h=a/s*a;return{totalHeight:s,totalWidth:p,left:x,top:w,width:i,height:h,isYLarge:f,isXLarge:g,isLarge:y}})});function z(l,d,t){const c=l.value,{containerXPadding:o,containerYPadding:m,canvasWidth:a,canvasHeight:u}=c,r=a*t,n=u*t,{width:p,height:s}=d.value,g=Math.max((p-r)/2,o),f=Math.max((s-n)/2,m),y=r+2*o>p?p-(r+o):g,x=n+2*m>s?s-(n+m):f;return{maxTranslateX:g,maxTranslateY:f,minTranslateX:y,minTranslateY:x}}const ne=(l,d,t)=>({boundaryInfo:e.computed(()=>z(l,d,t.scale))}),Y=(l,d,t,c)=>{const o=l.value;let{translateX:m,translateY:a,scale:u}=t;c=Math.min(Math.max(c,o.minScale),o.maxScale);const r=c-u,n=z(l,d,c);m-=r*o.canvasWidth/2,a-=r*o.canvasHeight/2,m=Math.max(Math.min(m,n.maxTranslateX),n.minTranslateX),a=Math.max(Math.min(a,n.maxTranslateY),n.minTranslateY),t.scale=c,t.translateX=m,t.translateY=a},oe=(l,d,t)=>{l.value.proxyScaleKey&&document.addEventListener("keydown",c=>{if(l.value.canScale){const o=c.keyCode;if((c.metaKey||c.ctrlKey)&&(o===187||o===189)){c.preventDefault();const m=t.scale+(o===187?.05:-.05);Y(l,d,t,m)}}})},re=(l,d,t,c,o,m,a)=>{let u=null;Object.assign(a,{xOpacity:0,yOpacity:0,scrollBarMouseDown:!1,scrollBarEnter:!1}),e.onMounted(()=>{o.value&&o.value.addEventListener("wheel",r=>{if(l.value.canScale)if(r.metaKey||r.ctrlKey){r.preventDefault();const n=-1*r.deltaY/100,p=t.scale+n;Y(l,d,t,p)}else{if(!m.value.isLarge||a.scrollBarMouseDown)return;r.preventDefault();let{translateX:n,translateY:p}=t;u&&clearTimeout(u);const s=-r.deltaX,g=-r.deltaY;let f="";const{opacity:y=.4}=l.value.scrollBarConfig,{isXLarge:x,isYLarge:w}=m.value,{maxTranslateX:i,minTranslateX:h,maxTranslateY:v,minTranslateY:S}=c.value;x&&Math.abs(s)>Math.abs(g)&&(n+=s,n=Math.max(Math.min(n,i),h),a.xOpacity=y,a.yOpacity=0,t.translateX=n,f="x"),w&&Math.abs(g)>Math.abs(s)&&(f="y",p+=g,p=Math.max(Math.min(p,v),S),a.yOpacity=y,a.xOpacity=0,t.translateY=p),f&&(u=setTimeout(()=>{a.scrollBarEnter||(a[f==="y"?"yOpacity":"xOpacity"]=0)},1e3))}})})},ae=e.defineComponent({__name:"index",props:e.mergeDefaults({scale:{},minScale:{},maxScale:{},canScale:{type:Boolean},autoCenter:{type:Boolean},autoScale:{type:Boolean},containerAutoSize:{type:Boolean},containerWidth:{},containerHeight:{},containerXPadding:{},containerYPadding:{},canvasWidth:{},canvasHeight:{},proxyScaleKey:{type:Boolean},useScrollBar:{type:Boolean},useRuler:{type:Boolean},usePositionLine:{type:Boolean},positionLineConfig:{},canvasStyle:{},scrollBarConfig:{},rulerConfig:{},onScale:{type:Function},onMove:{type:Function}},Q),emits:["update:scale"],setup(l,{expose:d,emit:t}){const c=l,o=e.ref(k(j,c)),m=t,a=e.ref(null),{containerInfo:u,containerStyle:r}=Z(o,a),{transformInfo:n}=ee(o,u),{boundaryInfo:p}=ne(o,u,n),{scrollBarInfo:s}=te(o,u,n),g=e.reactive({});e.watch(()=>n.scale,L=>{if(L){if(!g.scale){const B={scale:L,translateX:n.translateX,translateY:n.translateY};Object.assign(g,B)}m("update:scale",L)}}),e.watch(()=>c,()=>{o.value=k(o.value,c)},{deep:!0});function f(L){Y(o,u,n,L)}e.watch(()=>o.value.scale,L=>{L!==n.scale&&f(L)}),oe(o,u,n);const y=e.reactive({});re(o,u,n,p,a,s,y);function x(){Object.assign(n,g)}const w=e.ref(null),i=e.ref(null);function h(){o.value.useRuler&&(w.value&&w.value.removeAllPositionLine(),i.value&&i.value.removeAllPositionLine())}function v(L=!0){o.value.useRuler&&(w.value&&w.value.toggleRuler(L),i.value&&i.value.toggleRuler(L))}function S(L=!0){o.value.useRuler&&(w.value&&w.value.togglePositionLine(L),i.value&&i.value.togglePositionLine(L))}function b(L,B=!0,M=!1){o.value.useRuler&&(M&&w.value&&w.value.modifyAdsorptionList(L,B),!M&&i.value&&i.value.modifyAdsorptionList(L,B))}return d({reset:x,changeScale:f,removeAllPositionLine:h,showRuler(){v()},hideRuler(){v(!1)},showAllPositionLine(){S()},hideAllPositionLine(){S(!1)},addAdsorptionLine(L,B=!1){b(L,!0,B)},removeAdsorptionLine(L,B=!1){b(L,!1,B)}}),(L,B)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"container",ref:a,style:e.normalizeStyle(e.unref(r))},[o.value.useRuler?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(X,{ref_key:"xRuler",ref:w,opt:o.value,"container-info":e.unref(u),"transform-info":e.unref(n)},null,8,["opt","container-info","transform-info"]),e.createVNode(X,{ref_key:"yRuler",ref:i,"is-y":"",opt:o.value,"container-info":e.unref(u),"transform-info":e.unref(n)},null,8,["opt","container-info","transform-info"])],64)):e.createCommentVNode("",!0),e.createVNode(I,{"container-info":e.unref(u),opt:o.value,"transform-info":e.unref(n)},{default:e.withCtx(()=>[e.renderSlot(L.$slots,"default")]),_:3},8,["container-info","opt","transform-info"]),e.unref(s).isXLarge?(e.openBlock(),e.createBlock(T,{key:1,opt:o.value,"container-info":e.unref(u),"scroll-bar-info":e.unref(s),"global-info":y,"transform-info":e.unref(n)},null,8,["opt","container-info","scroll-bar-info","global-info","transform-info"])):e.createCommentVNode("",!0),e.unref(s).isYLarge?(e.openBlock(),e.createBlock(T,{key:2,opt:o.value,"container-info":e.unref(u),"scroll-bar-info":e.unref(s),"global-info":y,"transform-info":e.unref(n),"is-y":""},null,8,["opt","container-info","scroll-bar-info","global-info","transform-info"])):e.createCommentVNode("",!0)],4))}});module.exports=ae;
